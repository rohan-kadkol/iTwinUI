// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@import '../style/index';

$input-size: $iui-icons-default;

@mixin iui-checkbox-radio-wrapper {
  @include iui-reset;
  display: flex;
  align-items: center;
  font-size: $iui-font-size;
  width: fit-content;
  user-select: none;
  position: relative;
  cursor: pointer;
  @include themed {
    color: rgba(t(iui-color-foreground-body-rgb), t(iui-opacity-2));
  }

  &.iui-disabled,
  &.iui-loading {
    &,
    .iui-label {
      cursor: not-allowed;
      @include themed {
        color: t(iui-text-color-muted);
      }
    }

    .iui-label svg {
      @include themed {
        fill: t(iui-icons-color-actionable-disabled);
      }
    }
  }

  &.iui-disabled,
  &.iui-disabled .iui-label {
    cursor: not-allowed;
  }

  &.iui-loading {
    &,
    .iui-label {
      cursor: wait;
    }

    .iui-checkbox:disabled {
      border-color: transparent;
      background-color: transparent;
      cursor: wait;
    }

    .iui-progress-indicator-radial {
      position: absolute;
      width: $input-size;
      height: $input-size;
    }

    .iui-label ~ .iui-progress-indicator-radial {
      right: 0;
    }
  }

  .iui-label {
    display: flex;
    align-items: center;

    svg {
      width: $iui-icons-default;
      height: $iui-icons-default;
      vertical-align: middle;
      @include themed {
        fill: t(iui-icons-color-actionable);
      }
    }
  }

  // #region Input + label positioning
  .iui-label {
    text-align: right;
  }

  input[type='checkbox'] ~ .iui-label,
  input[type='radio'] ~ .iui-label {
    text-align: left;
  }

  @supports (gap: $iui-s) {
    gap: $iui-s;
  }
  @supports not (gap: $iui-s) {
    input[type='checkbox'] ~ .iui-label,
    input[type='radio'] ~ .iui-label {
      margin-left: $iui-s;
    }

    .iui-label ~ input[type='checkbox'],
    .iui-label ~ input[type='radio'] {
      margin-left: $iui-s;
    }
  }
  // #endregion

  // #region Statuses
  &.iui-positive {
    @include themed {
      color: t(iui-color-foreground-positive);
    }
  }

  &.iui-warning {
    @include themed {
      color: t(iui-color-foreground-warning);
    }
  }

  &.iui-negative {
    @include themed {
      color: t(iui-color-foreground-negative);
    }
  }
  // #endregion
}

@mixin iui-checkbox-radio {
  @include iui-reset;
  @include iui-focus($thickness: 2px, $offset: -1px);
  display: inline-block;
  flex-shrink: 0;
  position: relative;
  appearance: none;
  width: $input-size;
  height: $input-size;
  isolation: isolate;
  cursor: pointer;
  @include themed {
    background-color: t(iui-color-background-1);
    border-color: rgba(t(iui-color-foreground-body-rgb), t(iui-opacity-4));
  }

  &::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -1;
    transition: border-color $iui-speed-fast ease-out;
    border-radius: inherit;
    border-style: solid;
    border-width: 1px;
    border-color: inherit;
  }

  &::after {
    content: '';
    position: absolute;
    inset: 0;
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: $input-size;
  }

  &:checked,
  &:indeterminate {
    &:enabled {
      @include themed {
        border-color: rgba(t(iui-color-foreground-body-rgb), t(iui-opacity-3));
      }
    }

    &::after {
      @include themed {
        background-color: t(iui-color-foreground-primary);
      }
    }
  }

  &:enabled:hover {
    @include themed {
      border-color: rgba(t(iui-color-foreground-body-rgb), t(iui-opacity-2));
    }
  }

  &:disabled {
    cursor: not-allowed;
    @include themed {
      background-color: t(iui-color-background-disabled);
      border-color: t(iui-color-background-disabled);
    }

    &:checked::after,
    &:indeterminate::after {
      @include themed {
        background-color: t(iui-icons-color-actionable-disabled);
      }
    }
  }
}
